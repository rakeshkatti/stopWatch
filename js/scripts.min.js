var stopwatch=angular.module("stopwatch",[]);stopwatch.controller("appController",function($scope){function init(){$scope.timer={hours:0,minutes:0,seconds:0,ms:0}}$scope.laps=[],$scope.splits=[],$scope.identity=angular.identity,init();var interval,timeElapsed,startTime=0,pause=-999;$("#start").on("click",function(){$("#start,#stop").toggle(),$("#lap,#split").removeClass("disabled"),$("#reset").addClass("disabled")}),$scope.startTimer=function(){if($scope.timer.ms||$scope.timer.seconds||$scope.timer.ms){if(!pause)return;startTime=Date.now()+startTime-pause}else startTime=Date.now();pause=0,interval=setInterval(function(){$scope.$apply(function(){timeElapsed=Date.now()-startTime,$scope.timer={ms:timeElapsed%1e3,seconds:Math.floor(timeElapsed/1e3)%60,minutes:Math.floor(timeElapsed/1e3/60)%60,hours:Math.floor(timeElapsed/1e3/60/60)%60}})},1)},$scope.stopTimer=function(){if($("#start,#stop").toggle(),$("#reset").removeClass("disabled"),$("#lap,#split").addClass("disabled"),$scope.splits.length>0&&$scope.splits.push($scope.timer.minutes+":"+$scope.timer.seconds+":"+$scope.timer.ms),$scope.laps.length>0){var lap=[];if($scope.splits.length>0)for(var i=0;i<$scope.splits.length;i++)lap.push($scope.splits[i]);$scope.splits=[],lap.push($scope.timer.minutes+":"+$scope.timer.seconds+":"+$scope.timer.ms),$scope.laps.push(lap)}clearInterval(interval),pause=Date.now()},$scope.resetTimer=function(){pause&&($scope.laps=[],$scope.splits=[],init())},$scope.lapTimer=function(){if(0===pause){var lap=[];if($scope.splits.length>0)for(var i=0;i<$scope.splits.length;i++)lap.push($scope.splits[i]);$scope.splits=[],lap.push($scope.timer.minutes+":"+$scope.timer.seconds+":"+$scope.timer.ms),$scope.laps.push(lap),console.log("Laps :"+$scope.laps),clearInterval(interval),init(),$scope.startTimer()}},$scope.splitTimer=function(){0===pause&&($scope.splits.push($scope.timer.minutes+":"+$scope.timer.seconds+":"+$scope.timer.ms),console.log("Splits :"+$scope.splits))}});